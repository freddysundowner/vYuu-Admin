{"ast":null,"code":"import React,{useContext}from\"react\";import{CSVDownloader}from\"react-papaparse\";import{Table,TableHeader,TableCell,TableFooter,TableContainer,Select,Input,Card,CardBody,Pagination}from\"@windmill/react-ui\";import{IoCloudDownloadOutline}from\"react-icons/io5\";import useAsync from\"../hooks/useAsync\";import useFilter from\"../hooks/useFilter\";import NotFound from\"../components/table/NotFound\";import OrderServices from\"../services/OrderServices\";import Loading from\"../components/preloader/Loading\";import OrderTable from\"../components/order/OrderTable\";import PageTitle from\"../components/Typography/PageTitle\";import{SidebarContext}from\"../context/SidebarContext\";import{AdminContext}from\"../context/AdminContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const Orders=()=>{const{state,dispatch}=useContext(AdminContext);const{adminInfo}=state;const{time,setTime,currentPage,searchText,searchRef,status,setStatus,handleChangePage,handleSubmitForAll,resultsPerPage}=useContext(SidebarContext);const{data,loading}=useAsync(()=>OrderServices.getAllOrders({contact:searchText,status,page:currentPage,limit:resultsPerPage,day:time,userid:adminInfo.role==\"shopowner\"?adminInfo._id:\"\"}));const{dataTable,serviceData}=useFilter(data.orders);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageTitle,{children:\"Orders\"}),/*#__PURE__*/_jsx(Card,{className:\"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5\",children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitForAll,className:\"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:grid-cols-4 xl:grid-cols-4\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Input,{ref:searchRef,type:\"search\",className:\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\",placeholder:\"Search by invoice\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Select,{onChange:e=>setStatus(e.target.value),className:\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Status\",defaultValue:true,hidden:true,children:\"Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Delivered\",children:\"Delivered\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Processed\",children:\"Processing\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cancel\",children:\"Cancel\"})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Select,{onChange:e=>setTime(e.target.value),className:\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Order limits\",defaultValue:true,hidden:true,children:\"Order limits\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"Last 5 days orders\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7\",children:\"Last 7 days orders\"}),/*#__PURE__*/_jsx(\"option\",{value:\"15\",children:\"Last 15 days orders\"}),/*#__PURE__*/_jsx(\"option\",{value:\"30\",children:\"Last 30 days orders\"})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CSVDownloader,{data:serviceData,filename:\"orders\",children:/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"flex items-center justify-center text-sm leading-5 h-12 text-center transition-colors duration-150 font-medium focus:outline-none px-6 py-2 rounded-md text-white bg-green-500 border border-transparent active:bg-green-600 hover:bg-green-600 focus:ring focus:ring-purple-300 w-auto\",children:[\"Download all Orders\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-base\",children:/*#__PURE__*/_jsx(IoCloudDownloadOutline,{})})]})})})]})})}),loading?/*#__PURE__*/_jsx(Loading,{loading:loading}):serviceData.length!==0?/*#__PURE__*/_jsxs(TableContainer,{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHeader,{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Order Date\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Customer Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Service Fee\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Amount\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-center\",children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-center\",children:\"Action\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-right\",children:\"Invoice\"})]})}),/*#__PURE__*/_jsx(OrderTable,{orders:dataTable})]}),/*#__PURE__*/_jsx(TableFooter,{children:/*#__PURE__*/_jsx(Pagination,{totalResults:data===null||data===void 0?void 0:data.totalDoc,resultsPerPage:resultsPerPage,onChange:handleChangePage,label:\"Table navigation\"})})]}):/*#__PURE__*/_jsx(NotFound,{title:\"Order\"})]});};export default Orders;","map":{"version":3,"names":["React","useContext","CSVDownloader","Table","TableHeader","TableCell","TableFooter","TableContainer","Select","Input","Card","CardBody","Pagination","IoCloudDownloadOutline","useAsync","useFilter","NotFound","OrderServices","Loading","OrderTable","PageTitle","SidebarContext","AdminContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Orders","state","dispatch","adminInfo","time","setTime","currentPage","searchText","searchRef","status","setStatus","handleChangePage","handleSubmitForAll","resultsPerPage","data","loading","getAllOrders","contact","page","limit","day","userid","role","_id","dataTable","serviceData","orders","children","className","onSubmit","ref","type","placeholder","onChange","e","target","value","defaultValue","hidden","filename","length","totalResults","totalDoc","label","title"],"sources":["/var/www/admin/src/pages/Orders.js"],"sourcesContent":["import React, { useContext } from \"react\";\nimport { CSVDownloader } from \"react-papaparse\";\nimport {\n  Table,\n  TableHeader,\n  TableCell,\n  TableFooter,\n  TableContainer,\n  Select,\n  Input,\n  Card,\n  CardBody,\n  Pagination,\n} from \"@windmill/react-ui\";\nimport { IoCloudDownloadOutline } from \"react-icons/io5\";\n\nimport useAsync from \"../hooks/useAsync\";\nimport useFilter from \"../hooks/useFilter\";\nimport NotFound from \"../components/table/NotFound\";\nimport OrderServices from \"../services/OrderServices\";\nimport Loading from \"../components/preloader/Loading\";\nimport OrderTable from \"../components/order/OrderTable\";\nimport PageTitle from \"../components/Typography/PageTitle\";\nimport { SidebarContext } from \"../context/SidebarContext\";\nimport { AdminContext } from \"../context/AdminContext\";\nconst Orders = () => {\n  const { state, dispatch } = useContext(AdminContext);\n  const { adminInfo } = state;\n  const {\n    time,\n    setTime,\n    currentPage,\n    searchText,\n    searchRef,\n    status,\n    setStatus,\n    handleChangePage,\n    handleSubmitForAll,\n    resultsPerPage,\n  } = useContext(SidebarContext);\n\n  const { data, loading } = useAsync(() =>\n    OrderServices.getAllOrders({\n      contact: searchText,\n      status,\n      page: currentPage,\n      limit: resultsPerPage,\n      day: time,\n      userid: adminInfo.role == \"shopowner\" ? adminInfo._id : \"\",\n    })\n  );\n\n  const { dataTable, serviceData } = useFilter(data.orders);\n\n  return (\n    <>\n      <PageTitle>Orders</PageTitle>\n\n      <Card className=\"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5\">\n        <CardBody>\n          <form\n            onSubmit={handleSubmitForAll}\n            className=\"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:grid-cols-4 xl:grid-cols-4\"\n          >\n            <div>\n              <Input\n                ref={searchRef}\n                type=\"search\"\n                className=\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\"\n                placeholder=\"Search by invoice\"\n              />\n            </div>\n            <div>\n              <Select\n                onChange={(e) => setStatus(e.target.value)}\n                className=\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\"\n              >\n                <option value=\"Status\" defaultValue hidden>\n                  Status\n                </option>\n                <option value=\"Delivered\">Delivered</option>\n                <option value=\"Pending\">Pending</option>\n                <option value=\"Processed\">Processing</option>\n                <option value=\"Cancel\">Cancel</option>\n              </Select>\n            </div>\n            <div>\n              <Select\n                onChange={(e) => setTime(e.target.value)}\n                className=\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\"\n              >\n                <option value=\"Order limits\" defaultValue hidden>\n                  Order limits\n                </option>\n                <option value=\"5\">Last 5 days orders</option>\n                <option value=\"7\">Last 7 days orders</option>\n                <option value=\"15\">Last 15 days orders</option>\n                <option value=\"30\">Last 30 days orders</option>\n              </Select>\n            </div>\n            <div>\n              <CSVDownloader data={serviceData} filename={\"orders\"}>\n                <button\n                  type=\"button\"\n                  className=\"flex items-center justify-center text-sm leading-5 h-12 text-center transition-colors duration-150 font-medium focus:outline-none px-6 py-2 rounded-md text-white bg-green-500 border border-transparent active:bg-green-600 hover:bg-green-600 focus:ring focus:ring-purple-300 w-auto\"\n                >\n                  Download all Orders\n                  <span className=\"ml-2 text-base\">\n                    <IoCloudDownloadOutline />\n                  </span>\n                </button>\n              </CSVDownloader>\n            </div>\n          </form>\n        </CardBody>\n      </Card>\n      {loading ? (\n        <Loading loading={loading} />\n      ) : serviceData.length !== 0 ? (\n        <TableContainer className=\"mb-8\">\n          <Table>\n            <TableHeader>\n              <tr>\n                <TableCell>Order Date</TableCell>\n                <TableCell>Customer Name</TableCell>\n                <TableCell>Service Fee</TableCell>\n                <TableCell>Amount</TableCell>\n                <TableCell className=\"text-center\">Status</TableCell>\n                <TableCell className=\"text-center\">Action</TableCell>\n                <TableCell className=\"text-right\">Invoice</TableCell>\n              </tr>\n            </TableHeader>\n            <OrderTable orders={dataTable} />\n          </Table>\n          <TableFooter>\n            <Pagination\n              totalResults={data?.totalDoc}\n              resultsPerPage={resultsPerPage}\n              onChange={handleChangePage}\n              label=\"Table navigation\"\n            />\n          </TableFooter>\n        </TableContainer>\n      ) : (\n        <NotFound title=\"Order\" />\n      )}\n    </>\n  );\n};\n\nexport default Orders;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}