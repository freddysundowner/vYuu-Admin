{"ast":null,"code":"import React,{useContext}from\"react\";import{Table,TableHeader,TableCell,TableFooter,TableContainer,Select,Input,Button,Card,CardBody,Pagination}from\"@windmill/react-ui\";import{FiPlus}from\"react-icons/fi\";import{CSVReader,CSVDownloader}from\"react-papaparse\";import useAsync from\"../hooks/useAsync\";import useFilter from\"../hooks/useFilter\";import NotFound from\"../components/table/NotFound\";import Loading from\"../components/preloader/Loading\";import ProductServices from\"../services/ProductServices\";import PageTitle from\"../components/Typography/PageTitle\";import{SidebarContext}from\"../context/SidebarContext\";import ProductTable from\"../components/product/ProductTable\";import MainDrawer from\"../components/drawer/MainDrawer\";import ProductDrawer from\"../components/drawer/ProductDrawer\";import{AdminContext}from\"../context/AdminContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const Products=()=>{const{state,dispatch}=useContext(AdminContext);const{adminInfo}=state;const{toggleDrawer,currentPage,handleChangePage,searchText,category,setCategory,searchRef,handleSubmitForAll,sortedField,setSortedField,limitData}=useContext(SidebarContext);const{data,loading}=useAsync(()=>ProductServices.getAllProducts({page:currentPage,limit:limitData,category:category,title:searchText,price:sortedField,userid:adminInfo.role==\"admin\"?\"\":adminInfo._id}));// console.log(adminInfo);\nconst{serviceData}=useFilter(data.products);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageTitle,{children:\"Products\"}),/*#__PURE__*/_jsx(MainDrawer,{children:/*#__PURE__*/_jsx(ProductDrawer,{})}),/*#__PURE__*/_jsx(Card,{className:\"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5\",children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitForAll,className:\"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow\",children:[/*#__PURE__*/_jsx(Input,{ref:searchRef,className:\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\",type:\"search\",name:\"search\",placeholder:\"Search by product name\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"absolute right-0 top-0 mt-5 mr-1\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow\",children:/*#__PURE__*/_jsxs(Select,{onChange:e=>setSortedField(e.target.value),className:\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"All\",defaultValue:true,hidden:true,children:\"Price\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Low\",children:\"Low to High\"}),/*#__PURE__*/_jsx(\"option\",{value:\"High\",children:\"High to Low\"})]})})]})})}),loading?/*#__PURE__*/_jsx(Loading,{loading:loading}):(serviceData===null||serviceData===void 0?void 0:serviceData.length)!==0?/*#__PURE__*/_jsxs(TableContainer,{className:\"mb-8 rounded-b-lg\",children:[/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHeader,{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Product name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Category\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Price\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Stock\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Discount\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Details\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-center\",children:\"Published\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-center\",children:\"Featured\"}),/*#__PURE__*/_jsx(TableCell,{className:\"text-right\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(ProductTable,{products:data.products})]}),/*#__PURE__*/_jsx(TableFooter,{children:/*#__PURE__*/_jsx(Pagination,{totalResults:data===null||data===void 0?void 0:data.totalDoc,resultsPerPage:15,onChange:handleChangePage,label:\"Product Page Navigation\"})})]}):/*#__PURE__*/_jsx(NotFound,{title:\"Product\"})]});};export default Products;","map":{"version":3,"names":["React","useContext","Table","TableHeader","TableCell","TableFooter","TableContainer","Select","Input","Button","Card","CardBody","Pagination","FiPlus","CSVReader","CSVDownloader","useAsync","useFilter","NotFound","Loading","ProductServices","PageTitle","SidebarContext","ProductTable","MainDrawer","ProductDrawer","AdminContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Products","state","dispatch","adminInfo","toggleDrawer","currentPage","handleChangePage","searchText","category","setCategory","searchRef","handleSubmitForAll","sortedField","setSortedField","limitData","data","loading","getAllProducts","page","limit","title","price","userid","role","_id","serviceData","products","children","className","onSubmit","ref","type","name","placeholder","onChange","e","target","value","defaultValue","hidden","length","totalResults","totalDoc","resultsPerPage","label"],"sources":["/var/www/admin/src/pages/Products.js"],"sourcesContent":["import React, { useContext } from \"react\";\nimport {\n  Table,\n  TableHeader,\n  TableCell,\n  TableFooter,\n  TableContainer,\n  Select,\n  Input,\n  Button,\n  Card,\n  CardBody,\n  Pagination,\n} from \"@windmill/react-ui\";\nimport { FiPlus } from \"react-icons/fi\";\nimport { CSVReader, CSVDownloader } from \"react-papaparse\";\n\nimport useAsync from \"../hooks/useAsync\";\nimport useFilter from \"../hooks/useFilter\";\nimport NotFound from \"../components/table/NotFound\";\nimport Loading from \"../components/preloader/Loading\";\nimport ProductServices from \"../services/ProductServices\";\nimport PageTitle from \"../components/Typography/PageTitle\";\nimport { SidebarContext } from \"../context/SidebarContext\";\nimport ProductTable from \"../components/product/ProductTable\";\nimport MainDrawer from \"../components/drawer/MainDrawer\";\nimport ProductDrawer from \"../components/drawer/ProductDrawer\";\nimport { AdminContext } from \"../context/AdminContext\"; \n\n\nconst Products = () => {\n  const { state, dispatch } = useContext(AdminContext);\n  const { adminInfo } = state;\n  const {\n    toggleDrawer,\n    currentPage,\n    handleChangePage,\n    searchText,\n    category,\n    setCategory,\n    searchRef,\n    handleSubmitForAll,\n    sortedField,\n    setSortedField,\n    limitData,\n  } = useContext(SidebarContext);\n\n  const { data, loading } = useAsync(() =>\n    ProductServices.getAllProducts({\n      page: currentPage,\n      limit: limitData,\n      category: category,\n\n      title: searchText,\n      price: sortedField,\n      userid: adminInfo.role ==\"admin\"?\"\":adminInfo._id,\n    })\n  );\n  // console.log(adminInfo);\n\n  const { serviceData } = useFilter(data.products);\n\n  return (\n    <>\n      <PageTitle>Products</PageTitle>\n      <MainDrawer>\n        <ProductDrawer />\n      </MainDrawer>\n\n      <Card className=\"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5\">\n        <CardBody>\n          <form\n            onSubmit={handleSubmitForAll}\n            className=\"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex\"\n          >\n            <div className=\"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow\">\n              <Input\n                ref={searchRef}\n                className=\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\"\n                type=\"search\"\n                name=\"search\"\n                placeholder=\"Search by product name\"\n              />\n              <button\n                type=\"submit\"\n                className=\"absolute right-0 top-0 mt-5 mr-1\"\n              ></button>\n            </div>\n            <div className=\"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow\">\n              <Select\n                onChange={(e) => setSortedField(e.target.value)}\n                className=\"border h-12 text-sm focus:outline-none block w-full bg-gray-100 border-transparent focus:bg-white\"\n              >\n                <option value=\"All\" defaultValue hidden>\n                  Price\n                </option>\n                <option value=\"Low\">Low to High</option>\n                <option value=\"High\">High to Low</option>\n              </Select>\n            </div>\n          </form>\n        </CardBody>\n      </Card>\n\n      {loading ? (\n        <Loading loading={loading} />\n      ) : serviceData?.length !== 0 ? (\n        <TableContainer className=\"mb-8 rounded-b-lg\">\n          <Table>\n            <TableHeader>\n              <tr>\n                <TableCell>Product name</TableCell>\n                <TableCell>Category</TableCell>\n                <TableCell>Price</TableCell>\n                <TableCell>Stock</TableCell>\n                <TableCell>Status</TableCell>\n                <TableCell>Discount</TableCell>\n                <TableCell>Details</TableCell>\n                <TableCell className=\"text-center\">Published</TableCell>\n                <TableCell className=\"text-center\">Featured</TableCell>\n                <TableCell className=\"text-right\">Actions</TableCell>\n              </tr>\n            </TableHeader>\n            <ProductTable products={data.products} />\n          </Table>\n          <TableFooter>\n            <Pagination\n              totalResults={data?.totalDoc}\n              resultsPerPage={15}\n              onChange={handleChangePage}\n              label=\"Product Page Navigation\"\n            />\n          </TableFooter>\n        </TableContainer>\n      ) : (\n        <NotFound title=\"Product\" />\n      )}\n    </>\n  );\n};\n\nexport default Products;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}